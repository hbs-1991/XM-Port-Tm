(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[686],{1460:(e,s,r)=>{"use strict";r.d(s,{A:()=>i});var o=r(7620),t=r(96006),n=r(39039);function i(){let{data:e,status:s}=(0,t.useSession)(),{user:r,isAuthenticated:i,isLoading:a,error:l,setSession:u,login:c,logout:d,register:g,clearError:f}=(0,n.n)();(0,o.useEffect)(()=>{u(e)},[e,u]);let h=e=>(null==r?void 0:r.role)===e,m=e=>!!r&&e.includes(r.role);return{user:r,session:e,isAuthenticated:i,isLoading:a||"loading"===s,error:l,login:c,logout:d,register:g,clearError:f,hasRole:h,hasAnyRole:m,isAdmin:()=>h("ADMIN"),isProjectOwner:()=>h("PROJECT_OWNER"),canAccessAdmin:()=>m(["ADMIN","PROJECT_OWNER"])}}},27541:(e,s,r)=>{"use strict";var o=r(43041);r.o(o,"usePathname")&&r.d(s,{usePathname:function(){return o.usePathname}}),r.o(o,"useRouter")&&r.d(s,{useRouter:function(){return o.useRouter}})},39039:(e,s,r)=>{"use strict";r.d(s,{n:()=>i});var o=r(21367),t=r(50848),n=r(96006);let i=(0,o.vt)()((0,t.lt)((e,s)=>({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(r,o)=>{e({isLoading:!0,error:null});try{let t=await (0,n.signIn)("credentials",{email:r,password:o,redirect:!1});if(null==t?void 0:t.error)return e({error:"Invalid email or password",isLoading:!1}),!1;return await s().refreshSession(),e({isLoading:!1}),!0}catch(s){return e({error:"Login failed. Please try again.",isLoading:!1}),!1}},logout:async()=>{e({isLoading:!0});try{await (0,n.signOut)({redirect:!1}),e({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(s){e({error:"Logout failed",isLoading:!1})}},refreshSession:async()=>{try{let s=await (0,n.getSession)();(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}catch(s){console.error("Failed to refresh session:",s),e({session:null,user:null,isAuthenticated:!1})}},register:async r=>{e({isLoading:!0,error:null});try{let o="http://localhost:8000",t={email:r.email,password:r.password,first_name:r.firstName,last_name:r.lastName,company_name:r.companyName};console.log("=== API REQUEST DEBUG ==="),console.log("API URL:","".concat(o,"/api/v1/auth/register")),console.log("Request Body:",t),console.log("Request Headers:",{"Content-Type":"application/json",Accept:"application/json"});let n=await fetch("".concat(o,"/api/v1/auth/register"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(t)});if(console.log("=== API RESPONSE DEBUG ==="),console.log("Response Status:",n.status),console.log("Response Headers:",Object.fromEntries(n.headers.entries())),!n.ok){let s=await n.json();return console.log("Error Response Body:",s),console.log("Detailed Error:",{status:n.status,statusText:n.statusText,errorDetail:s.detail,fullError:s}),e({error:s.detail||"Registration failed",isLoading:!1}),!1}let i=await n.json();console.log("Success Response Body:",i),console.log("Registration successful! User created:",i.user);let a=await s().login(r.email,r.password);return e({isLoading:!1}),a}catch(s){return console.log("=== CATCH ERROR DEBUG ==="),console.error("Registration network/parsing error:",s),console.log("Error type:",typeof s),console.log("Error message:",s instanceof Error?s.message:"Unknown error"),e({error:"Registration failed. Please try again.",isLoading:!1}),!1}},clearError:()=>e({error:null}),setSession:s=>{(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}}),{name:"auth-store"}))},48052:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>i});var o=r(54568),t=r(27541),n=r(1460);function i(){let e=(0,t.useRouter)(),{logout:s}=(0,n.A)(),r=async()=>{await s(),e.push("/auth/login")};return(0,o.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,o.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:(0,o.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,o.jsx)("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:"Access Denied"}),(0,o.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"You don't have permission to access this page."})]}),(0,o.jsxs)("div",{className:"space-y-4",children:[(0,o.jsx)("button",{onClick:()=>e.back(),className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go Back"}),(0,o.jsx)("button",{onClick:()=>e.push("/dashboard"),className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Go to Dashboard"}),(0,o.jsx)("button",{onClick:r,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign Out"})]})]})})}},60994:(e,s,r)=>{Promise.resolve().then(r.bind(r,48052))}},e=>{e.O(0,[6,326,587,18,358],()=>e(e.s=60994)),_N_E=e.O()}]);