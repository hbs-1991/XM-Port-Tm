(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{1460:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var r=t(7620),a=t(96006),n=t(39039);function o(){let{data:e,status:s}=(0,a.useSession)(),{user:t,isAuthenticated:o,isLoading:i,error:l,setSession:d,login:c,logout:u,register:m,clearError:f}=(0,n.n)();(0,r.useEffect)(()=>{d(e)},[e,d]);let x=e=>(null==t?void 0:t.role)===e,h=e=>!!t&&e.includes(t.role);return{user:t,session:e,isAuthenticated:o,isLoading:i||"loading"===s,error:l,login:c,logout:u,register:m,clearError:f,hasRole:x,hasAnyRole:h,isAdmin:()=>x("ADMIN"),isProjectOwner:()=>x("PROJECT_OWNER"),canAccessAdmin:()=>h(["ADMIN","PROJECT_OWNER"])}}},21584:(e,s,t)=>{Promise.resolve().then(t.bind(t,73314))},25703:(e,s,t)=>{"use strict";t.d(s,{cn:()=>n});var r=t(72902),a=t(13714);function n(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.QP)((0,r.$)(s))}},39039:(e,s,t)=>{"use strict";t.d(s,{n:()=>o});var r=t(21367),a=t(50848),n=t(96006);let o=(0,r.vt)()((0,a.lt)((e,s)=>({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(t,r)=>{e({isLoading:!0,error:null});try{let a=await (0,n.signIn)("credentials",{email:t,password:r,redirect:!1});if(null==a?void 0:a.error)return e({error:"Invalid email or password",isLoading:!1}),!1;return await s().refreshSession(),e({isLoading:!1}),!0}catch(s){return e({error:"Login failed. Please try again.",isLoading:!1}),!1}},logout:async()=>{e({isLoading:!0});try{await (0,n.signOut)({redirect:!1}),e({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(s){e({error:"Logout failed",isLoading:!1})}},refreshSession:async()=>{try{let s=await (0,n.getSession)();(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}catch(s){console.error("Failed to refresh session:",s),e({session:null,user:null,isAuthenticated:!1})}},register:async t=>{e({isLoading:!0,error:null});try{let r="http://localhost:8000",a={email:t.email,password:t.password,first_name:t.firstName,last_name:t.lastName,company_name:t.companyName};console.log("=== API REQUEST DEBUG ==="),console.log("API URL:","".concat(r,"/api/v1/auth/register")),console.log("Request Body:",a),console.log("Request Headers:",{"Content-Type":"application/json",Accept:"application/json"});let n=await fetch("".concat(r,"/api/v1/auth/register"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)});if(console.log("=== API RESPONSE DEBUG ==="),console.log("Response Status:",n.status),console.log("Response Headers:",Object.fromEntries(n.headers.entries())),!n.ok){let s=await n.json();return console.log("Error Response Body:",s),console.log("Detailed Error:",{status:n.status,statusText:n.statusText,errorDetail:s.detail,fullError:s}),e({error:s.detail||"Registration failed",isLoading:!1}),!1}let o=await n.json();console.log("Success Response Body:",o),console.log("Registration successful! User created:",o.user);let i=await s().login(t.email,t.password);return e({isLoading:!1}),i}catch(s){return console.log("=== CATCH ERROR DEBUG ==="),console.error("Registration network/parsing error:",s),console.log("Error type:",typeof s),console.log("Error message:",s instanceof Error?s.message:"Unknown error"),e({error:"Registration failed. Please try again.",isLoading:!1}),!1}},clearError:()=>e({error:null}),setSession:s=>{(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}}),{name:"auth-store"}))},60460:(e,s,t)=>{"use strict";t.d(s,{$:()=>d,r:()=>l});var r=t(54568),a=t(7620),n=t(46118),o=t(54616),i=t(25703);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,s)=>{let{className:t,variant:a,size:o,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,i.cn)(l({variant:a,size:o,className:t})),ref:s,...c})});d.displayName="Button"},61445:(e,s,t)=>{"use strict";t.d(s,{E:()=>i});var r=t(54568);t(7620);var a=t(54616),n=t(25703);let o=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:t,...a}=e;return(0,r.jsx)("div",{className:(0,n.cn)(o({variant:t}),s),...a})}},73314:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>T});var r=t(54568),a=t(7620),n=t(19664),o=t.n(n),i=t(27541),l=t(1460);function d(e){let{children:s,requiredRole:t,allowedRoles:n,fallbackUrl:o="/auth/login"}=e,d=(0,i.useRouter)(),{isAuthenticated:c,isLoading:u,user:m,hasRole:f,hasAnyRole:x}=(0,l.A)();return((0,a.useEffect)(()=>{if(!u){if(!c)return void d.push(o);if(t&&!f(t)||n&&!x(n))return void d.push("/unauthorized")}},[c,u,m,t,n,f,x,d,o]),u)?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):c&&(!t||f(t))&&(!n||x(n))?(0,r.jsx)(r.Fragment,{children:s}):null}var c=t(96006),u=t(43002),m=t(32011),f=t(14502),x=t(19769),h=t(12598),g=t(80229),p=t(97152),v=t(72116),y=t(47573),N=t(16625),b=t(14486),j=t(6438),w=t(66970),A=t(25703);let R=N.bL,E=N.l9;N.YJ,N.ZL,N.Pb,N.z6,a.forwardRef((e,s)=>{let{className:t,inset:a,children:n,...o}=e;return(0,r.jsxs)(N.ZP,{ref:s,className:(0,A.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",t),...o,children:[n,(0,r.jsx)(b.A,{className:"ml-auto"})]})}).displayName=N.ZP.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(N.G5,{ref:s,className:(0,A.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...a})}).displayName=N.G5.displayName;let k=a.forwardRef((e,s)=>{let{className:t,sideOffset:a=4,...n}=e;return(0,r.jsx)(N.ZL,{children:(0,r.jsx)(N.UC,{ref:s,sideOffset:a,className:(0,A.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})})});k.displayName=N.UC.displayName;let _=a.forwardRef((e,s)=>{let{className:t,inset:a,...n}=e;return(0,r.jsx)(N.q7,{ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",a&&"pl-8",t),...n})});_.displayName=N.q7.displayName,a.forwardRef((e,s)=>{let{className:t,children:a,checked:n,...o}=e;return(0,r.jsxs)(N.H_,{ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...o,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(N.VF,{children:(0,r.jsx)(j.A,{className:"h-4 w-4"})})}),a]})}).displayName=N.H_.displayName,a.forwardRef((e,s)=>{let{className:t,children:a,...n}=e;return(0,r.jsxs)(N.hN,{ref:s,className:(0,A.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(N.VF,{children:(0,r.jsx)(w.A,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=N.hN.displayName;let L=a.forwardRef((e,s)=>{let{className:t,inset:a,...n}=e;return(0,r.jsx)(N.JU,{ref:s,className:(0,A.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...n})});L.displayName=N.JU.displayName;let C=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(N.wv,{ref:s,className:(0,A.cn)("-mx-1 my-1 h-px bg-muted",t),...a})});C.displayName=N.wv.displayName;var P=t(60460),z=t(9352);let O=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(z.bL,{ref:s,className:(0,A.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})});O.displayName=z.bL.displayName,a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(z._V,{ref:s,className:(0,A.cn)("aspect-square h-full w-full",t),...a})}).displayName=z._V.displayName;let S=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)(z.H4,{ref:s,className:(0,A.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})});S.displayName=z.H4.displayName;var U=t(61445);let D=[{name:"Dashboard",href:"/dashboard",icon:u.A},{name:"Upload Files",href:"/dashboard/upload",icon:m.A},{name:"Processing History",href:"/dashboard/history",icon:f.A},{name:"Profile",href:"/dashboard/profile",icon:x.A}];function T(e){var s,t,n,u;let{children:m}=e,[f,N]=(0,a.useState)(!1),b=(0,i.usePathname)(),{user:j}=(0,l.A)(),w=async()=>{await (0,c.signOut)({callbackUrl:"/"})};return(0,r.jsx)(d,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[f&&(0,r.jsx)("div",{className:"fixed inset-0 z-40 bg-gray-600 bg-opacity-75 lg:hidden",onClick:()=>N(!1)}),(0,r.jsxs)("div",{className:"fixed inset-y-0 left-0 z-50 w-64 transform bg-white shadow-lg transition-transform duration-300 ease-in-out lg:hidden ".concat(f?"translate-x-0":"-translate-x-full"),children:[(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between px-4",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"XM-Port"}),(0,r.jsx)("button",{onClick:()=>N(!1),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(h.A,{className:"h-6 w-6"})})]}),(0,r.jsx)("nav",{className:"mt-5 space-y-1 px-2",children:D.map(e=>{let s=b===e.href;return(0,r.jsxs)(o(),{href:e.href,onClick:()=>N(!1),className:"group flex items-center rounded-md px-2 py-2 text-sm font-medium transition-colors ".concat(s?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),children:[(0,r.jsx)(e.icon,{className:"mr-3 h-5 w-5 flex-shrink-0 ".concat(s?"text-blue-700":"text-gray-400 group-hover:text-gray-500")}),e.name]},e.name)})})]}),(0,r.jsx)("div",{className:"hidden lg:fixed lg:inset-y-0 lg:flex lg:w-64 lg:flex-col",children:(0,r.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col border-r border-gray-200 bg-white",children:[(0,r.jsx)("div",{className:"flex h-16 flex-shrink-0 items-center px-4 border-b border-gray-200",children:(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"XM-Port"})}),(0,r.jsx)("nav",{className:"mt-5 flex-1 space-y-1 px-2",children:D.map(e=>{let s=b===e.href;return(0,r.jsxs)(o(),{href:e.href,className:"group flex items-center rounded-md px-2 py-2 text-sm font-medium transition-colors ".concat(s?"bg-blue-50 text-blue-700":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),children:[(0,r.jsx)(e.icon,{className:"mr-3 h-5 w-5 flex-shrink-0 ".concat(s?"text-blue-700":"text-gray-400 group-hover:text-gray-500")}),e.name]},e.name)})})]})}),(0,r.jsxs)("div",{className:"lg:pl-64",children:[(0,r.jsx)("header",{className:"sticky top-0 z-30 bg-white shadow",children:(0,r.jsx)("div",{className:"px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex h-16 items-center justify-between",children:[(0,r.jsx)("button",{onClick:()=>N(!0),className:"text-gray-500 hover:text-gray-700 lg:hidden",children:(0,r.jsx)(g.A,{className:"h-6 w-6"})}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:j&&(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(p.A,{className:"h-5 w-5 text-gray-400"}),(0,r.jsxs)("div",{className:"text-sm",children:[(0,r.jsx)("span",{className:"text-gray-500",children:"Credits:"}),(0,r.jsx)(U.E,{variant:"outline",className:"ml-2",children:null!=(t=null==(s=j.creditsRemaining)?void 0:s.toLocaleString())?t:"0"})]})]})}),(0,r.jsxs)(R,{children:[(0,r.jsx)(E,{asChild:!0,children:(0,r.jsxs)(P.$,{variant:"ghost",className:"flex items-center space-x-3 hover:bg-gray-50",children:[(0,r.jsx)(O,{className:"h-8 w-8",children:(0,r.jsx)(S,{className:"bg-blue-500 text-white",children:j?"".concat((null==(n=j.firstName)?void 0:n[0])||"").concat((null==(u=j.lastName)?void 0:u[0])||"").toUpperCase():"U"})}),(0,r.jsxs)("div",{className:"hidden text-left sm:block",children:[(0,r.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:[null==j?void 0:j.firstName," ",null==j?void 0:j.lastName]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:null==j?void 0:j.email})]}),(0,r.jsx)(v.A,{className:"h-4 w-4 text-gray-400"})]})}),(0,r.jsxs)(k,{align:"end",className:"w-56",children:[(0,r.jsx)(L,{children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-medium",children:[null==j?void 0:j.firstName," ",null==j?void 0:j.lastName]}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:null==j?void 0:j.email}),(null==j?void 0:j.companyName)&&(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:j.companyName})]})}),(0,r.jsx)(C,{}),(0,r.jsx)(_,{asChild:!0,children:(0,r.jsxs)(o(),{href:"/dashboard/profile",className:"cursor-pointer",children:[(0,r.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Profile Settings"]})}),(0,r.jsx)(_,{asChild:!0,children:(0,r.jsxs)(o(),{href:"/dashboard/billing",className:"cursor-pointer",children:[(0,r.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Billing & Credits"]})}),(0,r.jsx)(C,{}),(0,r.jsxs)(_,{onClick:w,className:"cursor-pointer text-red-600 focus:text-red-600",children:[(0,r.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Sign Out"]})]})]})]})})}),(0,r.jsx)("main",{className:"flex-1",children:(0,r.jsx)("div",{className:"px-4 py-6 sm:px-6 lg:px-8",children:m})})]})]})})}}},e=>{e.O(0,[6,326,954,532,938,533,31,587,18,358],()=>e(e.s=21584)),_N_E=e.O()}]);