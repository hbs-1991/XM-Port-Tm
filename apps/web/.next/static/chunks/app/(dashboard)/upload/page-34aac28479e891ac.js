(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[394],{8129:(e,s,a)=>{"use strict";a.d(s,{k:()=>i});var t=a(54568),r=a(7620),l=a(1161),n=a(25703);let i=r.forwardRef((e,s)=>{let{className:a,value:r,...i}=e;return(0,t.jsx)(l.bL,{ref:s,className:(0,n.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,t.jsx)(l.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});i.displayName=l.bL.displayName},15998:(e,s,a)=>{"use strict";a.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>i});var t=a(54568),r=a(7620),l=a(25703);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...r})});n.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",a),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",a),...r})});c.displayName="CardContent",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",a),...r})}).displayName="CardFooter"},16741:(e,s,a)=>{Promise.resolve().then(a.bind(a,37724))},19536:(e,s,a)=>{"use strict";a.d(s,{p:()=>n});var t=a(54568),r=a(7620),l=a(25703);let n=r.forwardRef((e,s)=>{let{className:a,type:r,...n}=e;return(0,t.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...n})});n.displayName="Input"},25703:(e,s,a)=>{"use strict";a.d(s,{cn:()=>l});var t=a(72902),r=a(13714);function l(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,r.QP)((0,t.$)(s))}},37724:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>O});var t=a(54568),r=a(7620),l=a(67915),n=a(4869),i=a(47124),d=a(15998),o=a(60460),c=a(61445),u=a(57542),m=a(32011),x=a(75892),h=a(12598),f=a(99935),g=a(28653);class p{async fetchWithAuth(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a={...s.headers},t=await fetch("".concat("/api/proxy").concat(e),{...s,headers:a});if(!t.ok)throw Error((await t.json().catch(()=>({message:"Network error"}))).message||"HTTP ".concat(t.status));return t}async uploadFile(e){let{file:s,fileId:a,countrySchema:t,onProgress:r}=e;return new Promise((e,a)=>{let l=new FormData;l.append("file",s),l.append("country_schema",t);let n=new XMLHttpRequest;n.upload.addEventListener("progress",e=>{if(e.lengthComputable){let s=e.loaded/e.total*100;null==r||r(s)}}),n.addEventListener("load",async()=>{try{if(200===n.status||201===n.status){let s=JSON.parse(n.responseText);e(s)}else{let e=JSON.parse(n.responseText);a(Error(e.message||"Upload failed with status ".concat(n.status)))}}catch(e){a(Error("Failed to parse server response"))}}),n.addEventListener("error",()=>{a(Error("Network error during upload"))}),n.addEventListener("abort",()=>{a(Error("Upload was cancelled"))}),n.addEventListener("timeout",()=>{a(Error("Upload timed out"))}),n.timeout=3e5,n.open("POST","".concat("/api/proxy","/api/v1/processing/upload")),n.send(l)})}async getProcessingJob(e){let s=await this.fetchWithAuth("/api/v1/processing/jobs/".concat(e));return await s.json()}async getUserJobs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=await this.fetchWithAuth("/api/v1/processing/jobs?limit=".concat(e,"&offset=").concat(s));return await a.json()}async cancelProcessingJob(e){await this.fetchWithAuth("/api/v1/processing/jobs/".concat(e,"/cancel"),{method:"POST"})}async retryProcessingJob(e){let s=await this.fetchWithAuth("/api/v1/processing/jobs/".concat(e,"/retry"),{method:"POST"});return await s.json()}async downloadResults(e){return(await this.fetchWithAuth("/api/v1/processing/jobs/".concat(e,"/download"))).blob()}async validateFile(e){let s=new FormData;s.append("file",e);let a=await this.fetchWithAuth("/api/v1/processing/validate",{method:"POST",body:s});return await a.json()}}let v=new p,j=v.uploadFile.bind(v);v.getProcessingJob.bind(v),v.getUserJobs.bind(v),v.cancelProcessingJob.bind(v),v.retryProcessingJob.bind(v),v.downloadResults.bind(v);let y=v.validateFile.bind(v);var N=a(75792),b=a(19536),w=a(34391),k=a(74717),C=a(70783),A=a(31241),E=a(85973),R=a(14486);function F(e){let{data:s,fileName:a,editable:l=!1,onDataChange:n,maxRows:i=100}=e,[u,m]=(0,r.useState)(0),[x,g]=(0,r.useState)(null),[p,v]=(0,r.useState)(""),[j,y]=(0,r.useState)(s),[F,P]=(0,r.useState)([]),_=Math.ceil(j.length/10),S=10*u,T=Math.min(S+10,j.length),V=j.slice(S,T),U=j.length>0?Object.keys(j[0]):[],z=["Product Description","Quantity","Unit","Value","Origin Country","Unit Price"];(0,r.useEffect)(()=>{D()},[j]);let D=()=>{let e=[];j.forEach((s,a)=>{z.forEach(t=>{let r=s[t];r&&("string"!=typeof r||""!==r.trim())||e.push({row:a,column:t,message:"Required field is empty"})}),["Quantity","Value","Unit Price"].forEach(t=>{let r=s[t];r&&isNaN(Number(r))&&e.push({row:a,column:t,message:"Must be a valid number"})}),["Quantity","Value","Unit Price"].forEach(t=>{let r=Number(s[t]);r&&r<=0&&e.push({row:a,column:t,message:"Must be greater than 0"})});let t=Number(s.Quantity),r=Number(s["Unit Price"]),l=Number(s.Value);if(t&&r&&l){let s=t*r,n=Math.max(.001*s,.01);Math.abs(s-l)>n&&e.push({row:a,column:"Value",message:"Value should be approximately ".concat(s.toFixed(2)," (Quantity \xd7 Unit Price)")})}}),P(e)},M=(e,s)=>{let a=S+e;return F.find(e=>e.row===a&&e.column===s)},L=()=>{if(!x)return;let e=S+x.row,s=[...j];s[e]={...s[e],[x.column]:p},y(s),g(null),v(""),null==n||n(s)},q=()=>{g(null),v("")};return j.length?(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)(d.Zp,{children:[(0,t.jsx)(d.aR,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(d.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,t.jsx)(w.A,{className:"w-5 h-5"}),"Data Preview - ",a]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[F.length>0?(0,t.jsxs)(c.E,{variant:"destructive",className:"flex items-center gap-1",children:[(0,t.jsx)(k.A,{className:"w-3 h-3"}),F.length," error",1!==F.length?"s":""]}):(0,t.jsxs)(c.E,{variant:"default",className:"flex items-center gap-1 bg-green-500",children:[(0,t.jsx)(f.A,{className:"w-3 h-3"}),"Valid"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[j.length," row",1!==j.length?"s":""]})]})]})}),(0,t.jsxs)(d.Wu,{children:[(0,t.jsx)("div",{className:"rounded-lg border overflow-hidden",children:(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)(N.XI,{children:[(0,t.jsx)(N.A0,{children:(0,t.jsxs)(N.Hj,{children:[(0,t.jsx)(N.nd,{className:"w-12 text-center",children:"#"}),U.map(e=>(0,t.jsx)(N.nd,{className:"min-w-32",children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[e,z.includes(e)&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]})},e))]})}),(0,t.jsx)(N.BF,{children:V.map((e,s)=>(0,t.jsxs)(N.Hj,{children:[(0,t.jsx)(N.nA,{className:"text-center text-gray-500 dark:text-gray-400 font-mono text-xs",children:S+s+1}),U.map(a=>{let r=(null==x?void 0:x.row)===s&&(null==x?void 0:x.column)===a,n=M(s,a);return(0,t.jsxs)(N.nA,{className:((e,s)=>{let a=M(e,s),t="p-2 text-sm";return a?"".concat(t," bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"):z.includes(s)?t:"".concat(t," bg-gray-50 dark:bg-gray-800/50")})(s,a),children:[r?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.p,{value:p,onChange:e=>v(e.target.value),onKeyDown:e=>{"Enter"===e.key&&L(),"Escape"===e.key&&q()},className:"h-8",autoFocus:!0}),(0,t.jsx)(o.$,{size:"sm",variant:"ghost",onClick:L,children:(0,t.jsx)(C.A,{className:"w-3 h-3"})}),(0,t.jsx)(o.$,{size:"sm",variant:"ghost",onClick:q,children:(0,t.jsx)(h.A,{className:"w-3 h-3"})})]}):(0,t.jsxs)("div",{className:"\n                                  flex items-center justify-between group\n                                  ".concat(l?"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700/50 p-1 rounded":"","\n                                "),onClick:()=>{l&&(g({row:s,column:a}),v(String(V[s][a]||"")))},children:[(0,t.jsx)("span",{className:"truncate",children:String(e[a]||"")}),l&&(0,t.jsx)(A.A,{className:"w-3 h-3 opacity-0 group-hover:opacity-50 flex-shrink-0"})]}),n&&(0,t.jsx)("div",{className:"mt-1",children:(0,t.jsx)(c.E,{variant:"destructive",className:"text-xs",children:n.message})})]},a)})]},S+s))})]})})}),_>1&&(0,t.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,t.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",S+1," to ",T," of ",j.length," rows"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{m(e=>Math.max(0,e-1))},disabled:0===u,children:[(0,t.jsx)(E.A,{className:"w-4 h-4"}),"Previous"]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:Array.from({length:_},(e,s)=>(0,t.jsx)(o.$,{variant:u===s?"default":"outline",size:"sm",onClick:()=>m(s),className:"w-8 h-8 p-0",children:s+1},s))}),(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>{m(e=>Math.min(_-1,e+1))},disabled:u===_-1,children:["Next",(0,t.jsx)(R.A,{className:"w-4 h-4"})]})]})]})]})]})}):(0,t.jsx)(d.Zp,{children:(0,t.jsxs)(d.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(w.A,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,t.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No data to preview"})]})})}var P=a(8129),_=a(60844);function S(e){let{progress:s,fileName:a,onCancel:r,showCancel:l=!0}=e;return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(_.A,{className:"w-4 h-4 animate-spin text-blue-500"}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:s<20?"Validating file...":s<50?"Uploading...":s<80?"Processing data...":s<95?"Finalizing...":"Complete!"})]}),l&&r&&(0,t.jsxs)(o.$,{variant:"ghost",size:"sm",onClick:r,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:[(0,t.jsx)(h.A,{className:"w-4 h-4"}),"Cancel"]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(P.k,{value:s,className:"w-full"}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:[(0,t.jsx)("span",{children:a}),(0,t.jsxs)("span",{children:[Math.round(s),"%"]})]})]})]})}var T=a(74624),V=a(45234),U=a(81983);function z(e){var s,a,l;let{file:n,onValidationComplete:m,onRetry:h,className:p=""}=e,[v,j]=(0,r.useState)(null),[N,b]=(0,r.useState)(!1),w=(0,i.n)({mutationFn:y,onSuccess:e=>{j(e),null==m||m(e)},onError:e=>{console.error("Validation error:",e);let s={valid:!1,errors:[{field:"file",error:e.message||"Validation failed"}],warnings:[],total_rows:0,valid_rows:0};j(s),null==m||m(s)}});r.useEffect(()=>{n&&(j(null),w.mutate(n))},[n]);let C=(0,r.useCallback)(()=>{j(null),w.mutate(n),null==h||h()},[n,w,h]);return(0,t.jsxs)(d.Zp,{className:p,children:[(0,t.jsx)(d.aR,{children:(0,t.jsxs)(d.ZB,{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)(x.A,{className:"w-4 h-4"}),"Real-time Validation"]})}),(0,t.jsxs)(d.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[w.isPending?(0,t.jsx)(T.A,{className:"w-5 h-5 text-blue-500 animate-spin"}):(null==v?void 0:v.valid)?(0,t.jsx)(f.A,{className:"w-5 h-5 text-green-500"}):(null==v?void 0:v.errors.length)?(0,t.jsx)(g.A,{className:"w-5 h-5 text-red-500"}):(0,t.jsx)(k.A,{className:"w-5 h-5 text-yellow-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:w.isPending?"Validating file...":(null==v?void 0:v.valid)?"File validation successful! ".concat(v.valid_rows," of ").concat(v.total_rows," rows are valid."):(null==v?void 0:v.errors.length)?"Validation failed with ".concat(v.errors.length," error(s)."):"File validation completed with warnings."}),w.isPending&&(0,t.jsx)(P.k,{value:65,className:"w-full h-2 mt-2"})]}),v&&!w.isPending&&(0,t.jsxs)(o.$,{variant:"outline",size:"sm",onClick:C,className:"ml-auto",children:[(0,t.jsx)(V.A,{className:"w-3 h-3 mr-1"}),"Retry"]})]}),v&&!w.isPending&&(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsxs)(c.E,{variant:"outline",children:[v.total_rows," Total Rows"]}),(0,t.jsxs)(c.E,{variant:v.valid_rows===v.total_rows?"default":"secondary",children:[v.valid_rows," Valid Rows"]}),v.errors.length>0&&(0,t.jsxs)(c.E,{variant:"destructive",children:[v.errors.length," Error",1!==v.errors.length?"s":""]}),v.warnings.length>0&&(0,t.jsxs)(c.E,{variant:"outline",className:"border-yellow-500 text-yellow-600",children:[v.warnings.length," Warning",1!==v.warnings.length?"s":""]})]}),v.summary&&(0,t.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)(U.A,{className:"w-5 h-5 text-blue-500"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Data Quality Score:"}),(0,t.jsxs)("span",{className:"text-sm font-bold ".concat((a=v.summary.data_quality_score)>=90?"text-green-600":a>=70?"text-yellow-600":"text-red-600"),children:[Math.round(v.summary.data_quality_score),"%"]}),(0,t.jsx)(c.E,{variant:"outline",className:"text-xs",children:(l=v.summary.data_quality_score)>=90?"Excellent":l>=70?"Good":l>=50?"Fair":"Poor"})]}),(0,t.jsx)(P.k,{value:v.summary.data_quality_score,className:"w-full h-2 mt-1"})]})]}),v.errors.length>0&&(0,t.jsxs)(u.Fc,{variant:"destructive",children:[(0,t.jsx)(g.A,{className:"w-4 h-4"}),(0,t.jsx)(u.XL,{children:"Validation Errors"}),(0,t.jsx)(u.TN,{children:(0,t.jsxs)("div",{className:"mt-2 space-y-1",children:[v.errors.slice(0,3).map((e,s)=>(0,t.jsxs)("div",{className:"text-xs",children:[(0,t.jsxs)("strong",{children:[e.field,":"]})," ",e.error,e.row&&(0,t.jsxs)("span",{className:" text-gray-500",children:[" (Row ",e.row,")"]})]},s)),v.errors.length>3&&(0,t.jsx)(o.$,{variant:"link",size:"sm",onClick:()=>b(!N),className:"p-0 h-auto text-xs underline",children:N?"Show Less":"Show ".concat(v.errors.length-3," More Errors")})]})})]}),N&&v.errors.length>3&&(0,t.jsx)(u.Fc,{variant:"destructive",children:(0,t.jsx)(u.TN,{children:(0,t.jsx)("div",{className:"space-y-1",children:v.errors.slice(3).map((e,s)=>(0,t.jsxs)("div",{className:"text-xs",children:[(0,t.jsxs)("strong",{children:[e.field,":"]})," ",e.error,e.row&&(0,t.jsxs)("span",{className:" text-gray-500",children:[" (Row ",e.row,")"]})]},s+3))})})}),v.warnings.length>0&&(0,t.jsxs)(u.Fc,{children:[(0,t.jsx)(k.A,{className:"w-4 h-4"}),(0,t.jsx)(u.XL,{children:"Warnings"}),(0,t.jsx)(u.TN,{children:(0,t.jsx)("div",{className:"mt-2 space-y-1",children:v.warnings.map((e,s)=>(0,t.jsx)("div",{className:"text-xs",children:e},s))})})]}),v.valid&&0===v.errors.length&&(0,t.jsxs)(u.Fc,{children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),(0,t.jsx)(u.XL,{children:"Validation Complete"}),(0,t.jsx)(u.TN,{children:"Your file is ready for processing. All required columns are present and data validation passed."})]}),(null==(s=v.summary)?void 0:s.most_common_errors.length)&&(0,t.jsxs)(u.Fc,{children:[(0,t.jsx)(g.A,{className:"w-4 h-4"}),(0,t.jsx)(u.XL,{children:"Most Common Issues"}),(0,t.jsx)(u.TN,{children:(0,t.jsx)("div",{className:"mt-2 space-y-1",children:v.summary.most_common_errors.slice(0,3).map((e,s)=>(0,t.jsxs)("div",{className:"text-xs",children:["• ",e]},s))})})]})]}),w.isPending&&(0,t.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,t.jsxs)("div",{className:"text-center space-y-2",children:[(0,t.jsx)(T.A,{className:"w-8 h-8 mx-auto text-blue-500 animate-pulse"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Analyzing your file structure and data..."})]})})]})]})}let D=["product description","quantity","unit","value","origin country","unit price"],M=["text/csv","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],L=[".csv",".xlsx",".xls"];async function q(e){return new Promise(s=>{let a=new FileReader;a.onload=e=>{try{var a;let t=(null==(a=e.target)?void 0:a.result).split("\n")[0].split(",").map(e=>e.trim().toLowerCase().replace(/["']/g,"")),r=D.filter(e=>!t.some(s=>s.includes(e)||e.includes(s))),l=[];for(let[e,s]of Object.entries({"product description":["description","product","item","goods"],quantity:["qty","amount","count"],unit:["uom","unit of measure","measure"],value:["price","cost","amount"],"origin country":["country","origin","country of origin"],"unit price":["price per unit","cost per unit","unit cost"]}))if(r.includes(e)){let a=t.find(e=>s.some(s=>e.includes(s)));a&&l.push('Column "'.concat(a,'" might be "').concat(e,'". Please verify column names match requirements.'))}s({hasRequiredColumns:0===r.length,missingColumns:r,detectedColumns:t,warnings:l})}catch(e){s({hasRequiredColumns:!1,missingColumns:D,detectedColumns:[],warnings:["Could not read file headers. Please ensure file is valid CSV format."]})}},a.onerror=()=>{s({hasRequiredColumns:!1,missingColumns:D,detectedColumns:[],warnings:["Error reading file. Please try again."]})};let t=e.slice(0,1024);a.readAsText(t)})}let W={"text/csv":[".csv"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"]};function B(e){let{onUploadComplete:s,onError:a,countrySchema:p="US"}=e,[v,y]=(0,r.useState)([]),[N,b]=(0,r.useState)(!1);(0,n.jE)();let w=(0,r.useRef)(null),k=(0,i.n)({mutationFn:j,onSuccess:(e,a)=>{let t=a.fileId;y(s=>s.map(s=>s.id===t?{...s,status:"completed",progress:100,job:e,previewData:e.previewData}:s)),null==s||s(e)},onError:(e,s)=>{var t,r;let l=s.fileId,n=(null==(r=e.response)||null==(t=r.data)?void 0:t.message)||e.message||"Upload failed";y(e=>e.map(e=>e.id===l?{...e,status:"error",error:n}:e)),null==a||a(n)}}),C=(0,r.useCallback)(async e=>{let s=function(e){let s=[],a=[];e.size>0xa00000&&s.push({field:"file_size",error:"File size (".concat(Math.round(e.size/1024/1024),"MB) exceeds maximum allowed size of 10MB")});let t=e.name.toLowerCase().slice(e.name.lastIndexOf("."));M.includes(e.type)||L.includes(t)||s.push({field:"file_type",error:"Unsupported file type. Only CSV and Excel files (.csv, .xlsx, .xls) are allowed. Detected type: ".concat(e.type||"unknown")}),e.name.trim()||s.push({field:"file_name",error:"File must have a valid name"}),".csv"===t&&"text/csv"!==e.type&&a.push("CSV file may have encoding issues. Ensure the file is saved with UTF-8 encoding."),e.size>5242880&&a.push("Large file detected. Upload and validation may take longer than usual.");let r=0===s.length;return{valid:r,errors:s,warnings:a,canUpload:r}}(e);if(!s.valid){var a;return(null==(a=s.errors[0])?void 0:a.error)||"File validation failed"}if(e.name.toLowerCase().endsWith(".csv"))try{let s=await q(e);if(!s.hasRequiredColumns)return"Missing required columns: ".concat(s.missingColumns.join(", "));s.warnings.length>0&&console.warn("CSV header validation warnings:",s.warnings)}catch(e){console.warn("Could not validate CSV headers:",e)}return null},[]),A=(0,r.useCallback)(e=>{e.forEach(async e=>{let s=await C(e);if(s){null==a||a(s);return}let t="".concat(e.name,"-").concat(Date.now()),r={file:e,id:t,status:"validating",progress:0};y(e=>[...e,r])})},[C,a]),{getRootProps:E,getInputProps:R,isDragActive:P}=(0,l.VB)({onDrop:A,accept:W,maxSize:0xa00000,multiple:!1,onDragEnter:()=>b(!0),onDragLeave:()=>b(!1),onDropAccepted:()=>b(!1),onDropRejected:()=>b(!1)}),_=e=>{y(s=>s.filter(s=>s.id!==e))};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(d.Zp,{children:[(0,t.jsx)(d.aR,{children:(0,t.jsxs)(d.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(m.A,{className:"w-5 h-5"}),"Upload Trade Data File"]})}),(0,t.jsxs)(d.Wu,{children:[(0,t.jsxs)("div",{...E(),className:"\n              border-2 border-dashed rounded-lg p-8 text-center cursor-pointer transition-colors\n              ".concat(P||N?"border-blue-500 bg-blue-50 dark:bg-blue-950":"border-gray-300 dark:border-gray-600 hover:border-gray-400 dark:hover:border-gray-500","\n            "),children:[(0,t.jsx)("input",{...R(),ref:w}),(0,t.jsx)(m.A,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,t.jsx)("p",{className:"text-lg font-medium text-gray-700 dark:text-gray-300 mb-2",children:P||N?"Drop your file here":"Drag & drop your file here"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"or click to select a file"}),(0,t.jsxs)("div",{className:"flex flex-wrap justify-center gap-2 mb-4",children:[(0,t.jsx)(c.E,{variant:"secondary",children:"CSV"}),(0,t.jsx)(c.E,{variant:"secondary",children:"XLSX"}),(0,t.jsx)(c.E,{variant:"secondary",children:"Max 10MB"})]}),(0,t.jsx)(o.$,{type:"button",variant:"outline",size:"sm",children:"Choose File"})]}),(0,t.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-gray-700 dark:text-gray-300 mb-2",children:"Required Columns:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["Product Description","Quantity","Unit","Value","Origin Country","Unit Price"].map(e=>(0,t.jsx)(c.E,{variant:"outline",className:"text-xs",children:e},e))})]})]})]}),v.length>0&&(0,t.jsx)("div",{className:"space-y-4",children:v.map(e=>{var s,a;return(0,t.jsx)(d.Zp,{className:"relative",children:(0,t.jsx)(d.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)(x.A,{className:"w-8 h-8 text-blue-500 flex-shrink-0 mt-1"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 dark:text-gray-100 truncate",children:e.file.name}),(0,t.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>_(e.id),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,t.jsx)(h.A,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-3",children:[(0,t.jsxs)("span",{children:[(e.file.size/1024/1024).toFixed(2)," MB"]}),(0,t.jsx)("span",{children:e.file.type||"Unknown type"}),(0,t.jsx)(c.E,{variant:"completed"===e.status?"default":"error"===e.status?"destructive":"validated"===e.status?"secondary":"outline",className:"text-xs",children:"validating"===e.status?"Validating...":"validated"===e.status?"Validated":"uploading"===e.status?"Uploading...":"processing"===e.status?"Processing...":"completed"===e.status?"Completed":"error"===e.status?"Error":"Pending"})]}),("validating"===e.status||"validated"===e.status||"error"===e.status)&&(0,t.jsx)(z,{file:e.file,onValidationComplete:s=>{var a;return a=e.id,void y(e=>e.map(e=>e.id===a?{...e,status:s.valid?"validated":"error",validationResult:s,error:s.valid?void 0:"File validation failed"}:e))},className:"mb-3"}),"validated"===e.status&&(null==(s=e.validationResult)?void 0:s.valid)&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)(o.$,{onClick:()=>(e=>{var s;let a=v.find(s=>s.id===e);a&&(null==(s=a.validationResult)?void 0:s.valid)&&(y(s=>s.map(s=>s.id===e?{...s,status:"uploading",progress:10}:s)),k.mutate({file:a.file,fileId:e,countrySchema:p,onProgress:s=>{y(a=>a.map(a=>a.id===e?{...a,progress:Math.min(s,90)}:a))}}))})(e.id),className:"w-full",children:"Upload File for Processing"})}),"uploading"===e.status&&(0,t.jsx)(S,{progress:e.progress,fileName:e.file.name,onCancel:()=>_(e.id)}),"completed"===e.status&&(0,t.jsxs)(u.Fc,{className:"mb-3",children:[(0,t.jsx)(f.A,{className:"w-4 h-4"}),(0,t.jsxs)(u.TN,{children:["Upload completed successfully! File processed with"," ",(null==(a=e.job)?void 0:a.totalProducts)||0," products."]})]}),"error"===e.status&&(0,t.jsxs)(u.Fc,{variant:"destructive",className:"mb-3",children:[(0,t.jsx)(g.A,{className:"w-4 h-4"}),(0,t.jsxs)(u.TN,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:e.error}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>(e=>{let s=v.find(s=>s.id===e);s&&(y(s=>s.map(s=>s.id===e?{...s,status:"uploading",progress:10,error:void 0}:s)),k.mutate({file:s.file,fileId:e,countrySchema:p,onProgress:s=>{y(a=>a.map(a=>a.id===e?{...a,progress:Math.min(s,90)}:a))}}))})(e.id),children:"Retry"})]})]}),e.previewData&&"completed"===e.status&&(0,t.jsx)(F,{data:e.previewData,fileName:e.file.name})]})]})})},e.id)})})]})}function O(){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Upload Files"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Upload your Excel or CSV files for HS code matching and XML generation"})]}),(0,t.jsx)(B,{})]})}},57542:(e,s,a)=>{"use strict";a.d(s,{Fc:()=>d,TN:()=>c,XL:()=>o});var t=a(54568),r=a(7620),l=a(54616),n=a(25703);let i=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=r.forwardRef((e,s)=>{let{className:a,variant:r,...l}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,n.cn)(i({variant:r}),a),...l})});d.displayName="Alert";let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("h5",{ref:s,className:(0,n.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})});o.displayName="AlertTitle";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,n.cn)("text-sm [&_p]:leading-relaxed",a),...r})});c.displayName="AlertDescription"},60460:(e,s,a)=>{"use strict";a.d(s,{$:()=>o,r:()=>d});var t=a(54568),r=a(7620),l=a(46118),n=a(54616),i=a(25703);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,s)=>{let{className:a,variant:r,size:n,asChild:o=!1,...c}=e,u=o?l.DX:"button";return(0,t.jsx)(u,{className:(0,i.cn)(d({variant:r,size:n,className:a})),ref:s,...c})});o.displayName="Button"},61445:(e,s,a)=>{"use strict";a.d(s,{E:()=>i});var t=a(54568);a(7620);var r=a(54616),l=a(25703);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,l.cn)(n({variant:a}),s),...r})}},75792:(e,s,a)=>{"use strict";a.d(s,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>n,nA:()=>u,nd:()=>c});var t=a(54568),r=a(7620),l=a(25703);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,l.cn)("w-full caption-bottom text-sm",a),...r})})});n.displayName="Table";let i=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("thead",{ref:s,className:(0,l.cn)("[&_tr]:border-b",a),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...r})});d.displayName="TableBody",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tr",{ref:s,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});o.displayName="TableRow";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("th",{ref:s,className:(0,l.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});c.displayName="TableHead";let u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("td",{ref:s,className:(0,l.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});u.displayName="TableCell",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("caption",{ref:s,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"}},e=>{e.O(0,[954,143,587,18,358],()=>e(e.s=16741)),_N_E=e.O()}]);