(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{1048:(e,s,r)=>{Promise.resolve().then(r.bind(r,4373))},1460:(e,s,r)=>{"use strict";r.d(s,{A:()=>o});var a=r(7620),t=r(6006),l=r(9039);function o(){let{data:e,status:s}=(0,t.useSession)(),{user:r,isAuthenticated:o,isLoading:n,error:i,setSession:d,login:u,logout:m,register:c,clearError:p}=(0,l.n)();(0,a.useEffect)(()=>{d(e)},[e,d]);let h=e=>(null==r?void 0:r.role)===e,f=e=>!!r&&e.includes(r.role);return{user:r,session:e,isAuthenticated:o,isLoading:n||"loading"===s,error:i,login:u,logout:m,register:c,clearError:p,hasRole:h,hasAnyRole:f,isAdmin:()=>h("ADMIN"),isProjectOwner:()=>h("PROJECT_OWNER"),canAccessAdmin:()=>f(["ADMIN","PROJECT_OWNER"])}}},4373:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var a=r(4568),t=r(7620),l=r(7541),o=r(1460),n=r(9039);function i(e){let{onSuccess:s,redirectTo:r="/dashboard"}=e,o=(0,l.useRouter)(),{register:i,isLoading:d,error:u,clearError:m}=(0,n.n)(),[c,p]=(0,t.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",companyName:""}),[h,f]=(0,t.useState)(!1),[g,x]=(0,t.useState)([]),b=async e=>{e.preventDefault(),m(),c.email&&c.password&&c.firstName&&c.lastName&&c.password===c.confirmPassword&&!(g.length>0)&&await i({email:c.email,password:c.password,firstName:c.firstName,lastName:c.lastName,companyName:c.companyName||void 0})&&(null==s||s(),o.push(r))},y=(e,s)=>{p(r=>({...r,[e]:s}))};return(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First name"}),(0,a.jsx)("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",required:!0,value:c.firstName,onChange:e=>y("firstName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"John"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last name"}),(0,a.jsx)("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",required:!0,value:c.lastName,onChange:e=>y("lastName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Doe"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:c.email,onChange:e=>y("email",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"john@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-700",children:"Company name (optional)"}),(0,a.jsx)("input",{id:"companyName",name:"companyName",type:"text",autoComplete:"organization",value:c.companyName,onChange:e=>y("companyName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Acme Corp"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsx)("input",{id:"password",name:"password",type:h?"text":"password",autoComplete:"new-password",required:!0,value:c.password,onChange:e=>{var s;return s=e.target.value,void(p(e=>({...e,password:s})),x((e=>{let s=[];return e.length<8&&s.push("At least 8 characters"),/[A-Z]/.test(e)||s.push("One uppercase letter"),/[a-z]/.test(e)||s.push("One lowercase letter"),/\d/.test(e)||s.push("One number"),/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(e)||s.push("One special character"),s})(s)))},className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password"}),(0,a.jsx)("button",{type:"button",onClick:()=>f(!h),className:"absolute inset-y-0 right-0 px-3 flex items-center text-sm text-gray-600 hover:text-gray-800",children:h?"Hide":"Show"})]}),g.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:[(0,a.jsx)("p",{children:"Password must contain:"}),(0,a.jsx)("ul",{className:"list-disc list-inside",children:g.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),(0,a.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",autoComplete:"new-password",required:!0,value:c.confirmPassword,onChange:e=>y("confirmPassword",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your password"}),c.confirmPassword&&c.password!==c.confirmPassword&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Passwords do not match"})]}),u&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 border border-red-200 rounded-md p-3",children:u}),(0,a.jsx)("button",{type:"submit",disabled:d||!c.email||!c.password||!c.firstName||!c.lastName||c.password!==c.confirmPassword||g.length>0,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating account...":"Create account"})]})}function d(){let e=(0,l.useRouter)(),{isAuthenticated:s}=(0,o.A)();return((0,t.useEffect)(()=>{s&&e.push("/dashboard")},[s,e]),s)?null:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),(0,a.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,a.jsx)("a",{href:"/auth/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"sign in to your existing account"})]})]}),(0,a.jsx)("div",{className:"bg-white py-8 px-6 shadow rounded-lg",children:(0,a.jsx)(i,{})})]})})}},9039:(e,s,r)=>{"use strict";r.d(s,{n:()=>n});var a=r(1367),t=r(848),l=r(6006),o=r(7011);let n=(0,a.vt)()((0,t.lt)((e,s)=>({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(r,a)=>{e({isLoading:!0,error:null});try{let t=await (0,l.signIn)("credentials",{email:r,password:a,redirect:!1});if(null==t?void 0:t.error)return e({error:"Invalid email or password",isLoading:!1}),!1;return await s().refreshSession(),e({isLoading:!1}),!0}catch(s){return e({error:"Login failed. Please try again.",isLoading:!1}),!1}},logout:async()=>{e({isLoading:!0});try{await (0,l.signOut)({redirect:!1}),e({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(s){e({error:"Logout failed",isLoading:!1})}},refreshSession:async()=>{try{let s=await (0,l.getSession)();(null==s?void 0:s.user)?e({session:s,user:{id:s.user.id,email:s.user.email,name:s.user.name||"",role:s.user.role},isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}catch(s){console.error("Failed to refresh session:",s),e({session:null,user:null,isAuthenticated:!1})}},register:async r=>{e({isLoading:!0,error:null});try{let a=await fetch("".concat(o.env.NEXT_PUBLIC_API_URL,"/api/v1/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,password:r.password,first_name:r.firstName,last_name:r.lastName,company_name:r.companyName})});if(!a.ok){let s=await a.json();return e({error:s.detail||"Registration failed",isLoading:!1}),!1}let t=await s().login(r.email,r.password);return e({isLoading:!1}),t}catch(s){return e({error:"Registration failed. Please try again.",isLoading:!1}),!1}},clearError:()=>e({error:null}),setSession:s=>{(null==s?void 0:s.user)?e({session:s,user:{id:s.user.id,email:s.user.email,name:s.user.name||"",role:s.user.role},isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}}),{name:"auth-store"}))}},e=>{e.O(0,[341,587,18,358],()=>e(e.s=1048)),_N_E=e.O()}]);