(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{1460:(e,s,r)=>{"use strict";r.d(s,{A:()=>l});var a=r(7620),o=r(96006),t=r(39039);function l(){let{data:e,status:s}=(0,o.useSession)(),{user:r,isAuthenticated:l,isLoading:n,error:i,setSession:d,login:c,logout:u,register:m,clearError:p}=(0,t.n)();(0,a.useEffect)(()=>{d(e)},[e,d]);let h=e=>(null==r?void 0:r.role)===e,g=e=>!!r&&e.includes(r.role);return{user:r,session:e,isAuthenticated:l,isLoading:n||"loading"===s,error:i,login:c,logout:u,register:m,clearError:p,hasRole:h,hasAnyRole:g,isAdmin:()=>h("ADMIN"),isProjectOwner:()=>h("PROJECT_OWNER"),canAccessAdmin:()=>g(["ADMIN","PROJECT_OWNER"])}}},27541:(e,s,r)=>{"use strict";var a=r(43041);r.o(a,"usePathname")&&r.d(s,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(s,{useRouter:function(){return a.useRouter}})},34373:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>d});var a=r(54568),o=r(7620),t=r(27541),l=r(1460),n=r(39039);function i(e){let{onSuccess:s,redirectTo:r="/dashboard"}=e,l=(0,t.useRouter)(),{register:i,isLoading:d,error:c,clearError:u}=(0,n.n)(),[m,p]=(0,o.useState)({email:"",password:"",confirmPassword:"",firstName:"",lastName:"",companyName:""}),[h,g]=(0,o.useState)(!1),[f,x]=(0,o.useState)([]),y=async e=>{e.preventDefault(),u(),m.email&&m.password&&m.firstName&&m.lastName&&m.password===m.confirmPassword&&!(f.length>0)&&(console.log("=== REGISTRATION DEBUG ==="),console.log("Form Data:",{email:m.email,password:m.password,passwordLength:m.password.length,firstName:m.firstName,lastName:m.lastName,companyName:m.companyName||void 0}),console.log("Password validation errors:",f),console.log("Password meets requirements:",0===f.length),console.log('TIP: Try passwords like "TestPassword123!" or "SecurePass123!" if validation fails'),await i({email:m.email,password:m.password,firstName:m.firstName,lastName:m.lastName,companyName:m.companyName||void 0})&&(null==s||s(),l.push(r)))},w=(e,s)=>{p(r=>({...r,[e]:s}))};return(0,a.jsxs)("form",{onSubmit:y,className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"First name"}),(0,a.jsx)("input",{id:"firstName",name:"firstName",type:"text",autoComplete:"given-name",required:!0,value:m.firstName,onChange:e=>w("firstName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"John"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Last name"}),(0,a.jsx)("input",{id:"lastName",name:"lastName",type:"text",autoComplete:"family-name",required:!0,value:m.lastName,onChange:e=>w("lastName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Doe"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:m.email,onChange:e=>w("email",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"john@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-700",children:"Company name (optional)"}),(0,a.jsx)("input",{id:"companyName",name:"companyName",type:"text",autoComplete:"organization",value:m.companyName,onChange:e=>w("companyName",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Acme Corp"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,a.jsxs)("div",{className:"relative mt-1",children:[(0,a.jsx)("input",{id:"password",name:"password",type:h?"text":"password",autoComplete:"new-password",required:!0,value:m.password,onChange:e=>{var s;return s=e.target.value,void(p(e=>({...e,password:s})),x((e=>{let s=[];return e.length<8&&s.push("At least 8 characters"),/[A-Z]/.test(e)||s.push("One uppercase letter"),/[a-z]/.test(e)||s.push("One lowercase letter"),/\d/.test(e)||s.push("One number"),/[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(e)||s.push("One special character"),s})(s)))},className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your password"}),(0,a.jsx)("button",{type:"button",onClick:()=>g(!h),className:"absolute inset-y-0 right-0 px-3 flex items-center text-sm text-gray-600 hover:text-gray-800",children:h?"Hide":"Show"})]}),f.length>0&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:[(0,a.jsx)("p",{children:"Password must contain:"}),(0,a.jsx)("ul",{className:"list-disc list-inside",children:f.map((e,s)=>(0,a.jsx)("li",{children:e},s))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm password"}),(0,a.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",autoComplete:"new-password",required:!0,value:m.confirmPassword,onChange:e=>w("confirmPassword",e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your password"}),m.confirmPassword&&m.password!==m.confirmPassword&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:"Passwords do not match"})]}),c&&(0,a.jsx)("div",{className:"text-red-600 text-sm bg-red-50 border border-red-200 rounded-md p-3",children:c}),(0,a.jsx)("button",{type:"submit",disabled:d||!m.email||!m.password||!m.firstName||!m.lastName||m.password!==m.confirmPassword||f.length>0,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating account...":"Create account"})]})}function d(){let e=(0,t.useRouter)(),{isAuthenticated:s}=(0,l.A)();return((0,o.useEffect)(()=>{s&&e.push("/dashboard")},[s,e]),s)?null:(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"}),(0,a.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,a.jsx)("a",{href:"/auth/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"sign in to your existing account"})]})]}),(0,a.jsx)("div",{className:"bg-white py-8 px-6 shadow rounded-lg",children:(0,a.jsx)(i,{})})]})})}},39039:(e,s,r)=>{"use strict";r.d(s,{n:()=>l});var a=r(21367),o=r(50848),t=r(96006);let l=(0,a.vt)()((0,o.lt)((e,s)=>({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(r,a)=>{e({isLoading:!0,error:null});try{let o=await (0,t.signIn)("credentials",{email:r,password:a,redirect:!1});if(null==o?void 0:o.error)return e({error:"Invalid email or password",isLoading:!1}),!1;return await s().refreshSession(),e({isLoading:!1}),!0}catch(s){return e({error:"Login failed. Please try again.",isLoading:!1}),!1}},logout:async()=>{e({isLoading:!0});try{await (0,t.signOut)({redirect:!1}),e({user:null,session:null,isAuthenticated:!1,isLoading:!1,error:null})}catch(s){e({error:"Logout failed",isLoading:!1})}},refreshSession:async()=>{try{let s=await (0,t.getSession)();(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}catch(s){console.error("Failed to refresh session:",s),e({session:null,user:null,isAuthenticated:!1})}},register:async r=>{e({isLoading:!0,error:null});try{let a="http://localhost:8000",o={email:r.email,password:r.password,first_name:r.firstName,last_name:r.lastName,company_name:r.companyName};console.log("=== API REQUEST DEBUG ==="),console.log("API URL:","".concat(a,"/api/v1/auth/register")),console.log("Request Body:",o),console.log("Request Headers:",{"Content-Type":"application/json",Accept:"application/json"});let t=await fetch("".concat(a,"/api/v1/auth/register"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(o)});if(console.log("=== API RESPONSE DEBUG ==="),console.log("Response Status:",t.status),console.log("Response Headers:",Object.fromEntries(t.headers.entries())),!t.ok){let s=await t.json();return console.log("Error Response Body:",s),console.log("Detailed Error:",{status:t.status,statusText:t.statusText,errorDetail:s.detail,fullError:s}),e({error:s.detail||"Registration failed",isLoading:!1}),!1}let l=await t.json();console.log("Success Response Body:",l),console.log("Registration successful! User created:",l.user);let n=await s().login(r.email,r.password);return e({isLoading:!1}),n}catch(s){return console.log("=== CATCH ERROR DEBUG ==="),console.error("Registration network/parsing error:",s),console.log("Error type:",typeof s),console.log("Error message:",s instanceof Error?s.message:"Unknown error"),e({error:"Registration failed. Please try again.",isLoading:!1}),!1}},clearError:()=>e({error:null}),setSession:s=>{(null==s?void 0:s.user)?e({session:s,user:s.user,isAuthenticated:!0}):e({session:null,user:null,isAuthenticated:!1})}}),{name:"auth-store"}))},81048:(e,s,r)=>{Promise.resolve().then(r.bind(r,34373))}},e=>{e.O(0,[6,326,587,18,358],()=>e(e.s=81048)),_N_E=e.O()}]);